2024-05-06 13:09:46.433867: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-05-06 13:09:46.511410: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-05-06 13:09:49.333210: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/huggingface_hub/utils/_runtime.py:184: UserWarning: Pydantic is installed but cannot be imported. Please check your installation. `huggingface_hub` will default to not using Pydantic. Error message: '{e}'
  warnings.warn(
wandb: Currently logged in as: ferrazzipietro. Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /home/ferrazzi/.netrc
wandb: wandb version 0.16.6 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /extra/ferrazzi/llm/LS-LLaMA-E3C/wandb/run-20240506_131032-gu7zvvr6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 2024-05-06 13:09:58
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ferrazzipietro/finetune%20LS-Llama-2-7b-hf
wandb: üöÄ View run at https://wandb.ai/ferrazzipietro/finetune%20LS-Llama-2-7b-hf/runs/gu7zvvr6
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:11<00:11, 11.33s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:14<00:00,  6.80s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:14<00:00,  7.48s/it]
Some weights of LlamaForTokenClassification were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/501 [00:00<?, ?it/s]  0%|          | 1/501 [00:01<13:47,  1.65s/it]  0%|          | 2/501 [00:02<08:37,  1.04s/it]  1%|          | 3/501 [00:02<06:57,  1.19it/s]  1%|          | 4/501 [00:03<06:10,  1.34it/s]  1%|          | 5/501 [00:04<05:45,  1.44it/s]  1%|          | 6/501 [00:04<05:29,  1.50it/s]  1%|‚ñè         | 7/501 [00:05<05:18,  1.55it/s]  2%|‚ñè         | 8/501 [00:05<05:11,  1.58it/s]  2%|‚ñè         | 9/501 [00:06<05:06,  1.60it/s]  2%|‚ñè         | 10/501 [00:07<05:03,  1.62it/s]                                                  2%|‚ñè         | 10/501 [00:07<05:03,  1.62it/s]  2%|‚ñè         | 11/501 [00:07<05:01,  1.63it/s]  2%|‚ñè         | 12/501 [00:08<05:01,  1.62it/s]  3%|‚ñé         | 13/501 [00:08<04:58,  1.64it/s]  3%|‚ñé         | 14/501 [00:09<04:47,  1.70it/s]  3%|‚ñé         | 15/501 [00:09<04:29,  1.80it/s]  3%|‚ñé         | 16/501 [00:10<04:17,  1.89it/s]  3%|‚ñé         | 17/501 [00:10<04:08,  1.95it/s]  4%|‚ñé         | 18/501 [00:11<04:02,  1.99it/s]  4%|‚ñç         | 19/501 [00:11<03:57,  2.03it/s]  4%|‚ñç         | 20/501 [00:12<03:54,  2.05it/s]                                                  4%|‚ñç         | 20/501 [00:12<03:54,  2.05it/s]  4%|‚ñç         | 21/501 [00:12<03:52,  2.06it/s]  4%|‚ñç         | 22/501 [00:13<03:50,  2.08it/s]  5%|‚ñç         | 23/501 [00:13<03:49,  2.09it/s]  5%|‚ñç         | 24/501 [00:14<03:47,  2.09it/s]  5%|‚ñç         | 25/501 [00:14<03:46,  2.10it/s]  5%|‚ñå         | 26/501 [00:15<03:46,  2.10it/s]  5%|‚ñå         | 27/501 [00:15<03:45,  2.10it/s]  6%|‚ñå         | 28/501 [00:16<03:44,  2.10it/s]  6%|‚ñå         | 29/501 [00:16<03:44,  2.10it/s]  6%|‚ñå         | 30/501 [00:17<03:43,  2.10it/s]                                                  6%|‚ñå         | 30/501 [00:17<03:43,  2.10it/s]  6%|‚ñå         | 31/501 [00:17<03:43,  2.10it/s]  6%|‚ñã         | 32/501 [00:18<03:43,  2.10it/s]  7%|‚ñã         | 33/501 [00:18<03:42,  2.10it/s]  7%|‚ñã         | 34/501 [00:18<03:42,  2.10it/s]  7%|‚ñã         | 35/501 [00:19<03:41,  2.10it/s]  7%|‚ñã         | 36/501 [00:19<03:41,  2.10it/s]  7%|‚ñã         | 37/501 [00:20<03:40,  2.10it/s]  8%|‚ñä         | 38/501 [00:20<03:40,  2.10it/s]  8%|‚ñä         | 39/501 [00:21<03:40,  2.10it/s]  8%|‚ñä         | 40/501 [00:21<03:39,  2.10it/s]                                                  8%|‚ñä         | 40/501 [00:21<03:39,  2.10it/s]  8%|‚ñä         | 41/501 [00:22<03:39,  2.09it/s]  8%|‚ñä         | 42/501 [00:22<03:56,  1.94it/s]  9%|‚ñä         | 43/501 [00:23<04:08,  1.84it/s]  9%|‚ñâ         | 44/501 [00:24<04:16,  1.78it/s]  9%|‚ñâ         | 45/501 [00:24<04:23,  1.73it/s]  9%|‚ñâ         | 46/501 [00:25<04:26,  1.70it/s]  9%|‚ñâ         | 47/501 [00:25<04:29,  1.69it/s] 10%|‚ñâ         | 48/501 [00:26<04:30,  1.67it/s] 10%|‚ñâ         | 49/501 [00:27<04:31,  1.66it/s] 10%|‚ñâ         | 50/501 [00:27<04:32,  1.66it/s]                                                 10%|‚ñâ         | 50/501 [00:27<04:32,  1.66it/s] 10%|‚ñà         | 51/501 [00:28<04:33,  1.65it/s] 10%|‚ñà         | 52/501 [00:29<04:32,  1.65it/s] 11%|‚ñà         | 53/501 [00:29<04:32,  1.64it/s] 11%|‚ñà         | 54/501 [00:30<04:32,  1.64it/s] 11%|‚ñà         | 55/501 [00:30<04:31,  1.64it/s] 11%|‚ñà         | 56/501 [00:31<04:31,  1.64it/s] 11%|‚ñà‚ñè        | 57/501 [00:31<04:13,  1.75it/s] 12%|‚ñà‚ñè        | 58/501 [00:32<04:00,  1.84it/s] 12%|‚ñà‚ñè        | 59/501 [00:32<03:51,  1.91it/s] 12%|‚ñà‚ñè        | 60/501 [00:33<03:45,  1.96it/s]                                                 12%|‚ñà‚ñè        | 60/501 [00:33<03:45,  1.96it/s] 12%|‚ñà‚ñè        | 61/501 [00:33<03:41,  1.99it/s] 12%|‚ñà‚ñè        | 62/501 [00:34<03:37,  2.01it/s] 13%|‚ñà‚ñé        | 63/501 [00:34<03:35,  2.03it/s] 13%|‚ñà‚ñé        | 64/501 [00:35<03:33,  2.05it/s] 13%|‚ñà‚ñé        | 65/501 [00:35<03:31,  2.06it/s] 13%|‚ñà‚ñé        | 66/501 [00:36<03:30,  2.06it/s]